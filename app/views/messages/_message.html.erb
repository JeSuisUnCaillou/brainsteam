
<div class="message">
   
  <div class= "message_headbar">

    <div class="message_author">

      <div class="author_avatar center">
        <%= gravatar_for message.user, size: 30 %>
      </div>

      <div class="author_name center">
        <%= link_to truncate(message.user.name, length:20),
                    user_path(message.user) %>
      </div>

   </div>

    <div class="message_titles">

       <div class="message_subtitles">
         <small>
           <div class="creation_time">
             <%= time_ago_in_words message.created_at %> ago...
           </div>
           <div class="message_count"><!--a changer par message.answers_count-->
             <%= message.answers_count  %>
           </div>
         </small>
       </div>

       <div class="message_title">
         <h4> <%= message.title %> </h4>
       </div>

    </div>

  </div>

  <hr />

  <div class="message_text">
    <p><%= simple_format message.text %></p>
  </div>



  <div class="message_footer">

    <%= button_tag "Answer it", data: { message_id: message.id.to_s }, 
                                    class: "btn", id: "toggle_#{message.id}"%>

    <div class="message_form" id="message_form_<%= message.id.to_s %>" 
                              style="display: <%= Rails.env.test? ? 'block' : 'none'%>" >

      <%= button_tag "Hide", data: { message_id: message.id.to_s }, class: "btn" %>
   

      <%= form_for(@new_message, url: messages_path) do |m| %>
        <%= m.submit "Send", class: "btn btn-primary" %>
        <%= render partial: 'messages/form', locals: { m: m } %>
        <%= m.hidden_field :parent_node_id, value: message.treenode.id %>
        <%= m.hidden_field :threadhead_id, value: @threadhead.id %>
      <% end %>    
    </div>

  </div>

</div>


<div class="message_answers">


  <div class="table_scroll">

    <table class="table table-striped table-hover">
      <tbody>
        <%= render partial: 'messages/message_overview',
                             collection: message.children_messages %>
      </tbody>
    </table>

  </div>
 
</div>






